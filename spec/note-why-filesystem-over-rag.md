# Note: 为什么选择文件系统而非 RAG

本项目完全采用文件系统作为知识存储和检索方案，而非当前流行的 RAG（检索增强生成）方案。

## 核心观点

RAG 不是第一性原理的方案，而是一种妥协。

## 理由一：分片是权衡，不是本质

RAG 必须对文档进行分片（chunking），这是一个工程权衡：

1. **分片大小是人为选择**：chunk 太大会超出嵌入模型的上下文限制，太小会丢失语义完整性。无论怎么选，都是妥协。

2. **分片边界永远是问题**：一个完整的概念、函数、类可能被切割到不同的 chunk 中，导致检索时只能获取到残缺的信息。

3. **长上下文模型消解了这个问题**：当今的长上下文模型（100K+ tokens）已经可以直接处理完整文档，分片的前提不复存在。

4. **我们需要处理需要分块才能处理的超长文档吗**：不需要，索引文件永远没有代码的语法链接严谨，过大的index文件不如直接看代码/原文，失去了索引的意义。

## 理由二：语义相似 ≠ 语义相关

RAG 基于向量相似度检索，但这个假设本身是有问题的：

1. **我们查找资料不是因为"相似"**：当我们检索时，不知道问题的答案是什么，另一方面rag服务也无法穷举出所有可能的问题。我们寻找的是语义相关的内容，而非语义相似的内容。

2. **相似性是表面的**："如何配置数据库连接" 和 "数据库连接池的实现原理" 可能向量相似度很高，但一个是运维文档，一个是源码分析，使用场景完全不同。

3. **只有读过才知道是否相关**：真正的相关性判断需要理解上下文和意图，这是向量相似度无法捕捉的。文件系统 + 目录结构 + 文件命名本身就是人类组织知识的方式，天然具备语义。

## 结论

文件系统是更符合第一性原理的方案：

- 无损：没有分片，信息完整
- 透明：目录结构即知识结构，人机共读
- 简单：无需维护向量数据库，无需调优嵌入模型
